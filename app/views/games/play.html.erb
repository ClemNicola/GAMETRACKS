<div class="megamegadiv" data-controller="add-stats">

  <%= simple_form_for PlayerStat.new do |f| %>
    <%= f.hidden_field :game_id, value: @game.id %>

    <div class="divpoints">

      <div class="divpoints1">

        <%= label_tag :player_stat_ft_made, "1", class: "btn-green-round btn-margin1", data: { type: "ft_made", type_action: '+1 point â˜ï¸', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_2", point: '1' }%>
        <%= check_box_tag "player_stat[ft_made]", "1", false, hidden: true %>

        <%= label_tag :player_stat_fg_made, "2", class: "btn-green-round btn-margin1", data: { type: "fg_made", type_action: '+2 points âœŒï¸', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_2", point: '2' }%>
        <%= check_box_tag "player_stat[fg_made]", "1", false, hidden: true %>

        <%= label_tag :player_stat_threep_made, "3", class: "btn-green-round btn-margin2", data: { type: "threep_made", type_action: '+3 points ðŸ‘Œ', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_2", point: '3' }%>
        <%= check_box_tag "player_stat[threep_made]", "1", false, hidden: true %>

        <span class="material-symbols-outlined">menu</span>

      </div>

      <div class="divpoints2">

        <%= label_tag :player_stat_ft_attempt, "1", class: "btn-red-round btn-margin1", data: { type: "ft_attempt", type_action: 'FT missed ðŸ’©', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[ft_attempt]", "1", false, hidden: true %>

        <%= label_tag :player_stat_fg_attempt, "2", class: "btn-red-round btn-margin1", data: { type: "fg_attempt", type_action: 'FG missed ðŸ’©', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[fg_attempt]", "1", false, hidden: true %>

        <%= label_tag :player_stat_threep_attempt, "3", class: "btn-red-round btn-margin2", data: { type: "threep_attempt", type_action: '3pts missed ðŸ’©', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[threep_attempt]", "1", false, hidden: true %>

        <span class="material-symbols-outlined">undo</span>

      </div>

    </div>

    <div class="divaffichage">

      <div class="divdivaff">

        <div class="divaffichage1">
          <img src="<%= asset_path('bcm_logo.png') %>" alt="" class="logomatch">
          <%# SCORE DE LEQUIPE A CHANGER QUAND ON MARQUE %>
          <p data-add-stats-target='myScore'>0</p>
        </div>

        <div class="divaffichage2">
          <img src="<%= asset_path('sig_logo.png') %>" alt="" class="logomatch">
          <%# SCORE DE LEQUIPE A CHANGER QUAND ILS MARQUENT %>
          <p data-add-stats-target='opponentScore'>0</p>
        </div>

      </div>

      <div class="divaffichage3">

        <%# AFFICHER LES 3 DERNIERES STATS PRISES A FAIRE %>
        <div class="alexis">
          <div data-add-stats-target="player"></div>
          <div data-add-stats-target="action"></div>
        </div>

      </div>

    </div>

    <div class="divstats">

      <div class="divstats1">

        <%= label_tag :player_stat_block, "BLK", class: "btn-white-round btn-margin1", data: { type: "block", type_action: 'Block â›”', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" } %>
        <%= check_box_tag "player_stat[block]", "1", false, hidden: true %>

        <%= label_tag :player_stat_steal, "STL", class: "btn-white-round btn-margin1", data: { type: "steal", type_action: 'Steal ðŸ€', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[steal]", "1", false, hidden: true %>

        <%= label_tag :player_stat_off_rebound, "OR", class: "btn-white-round btn-margin2", data: { type: "off_rebound", type_action: 'Offensive Rebound ðŸ€', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[off_rebound]", "1", false, hidden: true %>

        <%# LOGIQUE A BOSSER FORT OU A NE PAS MONTRER PENDANT LA DEMO %>
        <%= label_tag :player_stat_minute, "Sub", class: "btn-rectangle", data: { type: "minute", type_action: 'substitution', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_3" }%>
        <%= check_box_tag "player_stat[minute]", "1", false, hidden: true %>

      </div>

      <div class="divstats2">

        <%= label_tag :player_stat_turnover, "TO", class: "btn-white-round btn-margin1", data: { type: "turnover", type_action: 'Turnover ðŸ˜©', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[turnover]", "1", false, hidden: true %>

        <%= label_tag :player_stat_assist, "AST", class: "btn-white-round btn-margin1", data: { type: "assist", type_action: 'Assist ðŸ€', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[assist]", "1", false, hidden: true %>

        <%= label_tag :player_stat_def_rebound, "DR", class: "btn-white-round btn-margin2", data: { type: "def_rebound", type_action: 'Defensive Rebound ðŸ€', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[def_rebound]", "1", false, hidden: true %>

        <%= label_tag :player_stat_fault, "Foul", class: "btn-rectangle", data: { type: "fault", type_action: 'Foul âŒ', action: "click->add-stats#action", bs_toggle: "modal", bs_target: "#stats_1" }%>
        <%= check_box_tag "player_stat[fault]", "1", false, hidden: true %>

      </div>

    </div>

    <%# MODAL POUR LA PRISE DE TOUTES LES STATS %>
    <div class="modal fade" id="stats_1" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="player-modal">
              <% @titulaires.each do |participation| %>
                <div class="card-select-player card-test1 photogood" data-action="click->add-stats#player" data-id="<%= participation.id %>" data-bs-dismiss="modal" data-name="<%= participation.user.name %>">
                  <img src="<%= participation.user.photo.present? ?cl_image_path(participation.user.photo.key) :asset_path('user.png') %>">
                  <p><%= participation.user.player_name %></p>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>


    <%# MODAL POUR LES POINTS MARQUES (5 joueurs titulaires + logo Ã©quipe adverse) %>
    <div class="modal fade" id="stats_2" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="player-modal player-team-modal">
              <div class="card-select-player card-test2" data-bs-dismiss="modal"  data-action="click->add-stats#player" data-team='opponent' data-name="<%= @away_team.city %>">
                <img src="<%= asset_path('sig_logo.png') %>" id="logomatchsig">
                <p><%= @away_team.city %></p>
              </div>
              <div class="laura">
                <% @titulaires.each do |participation| %>
                  <div class="card-select-player card-test1 photogood" data-action="click->add-stats#player" data-id="<%= participation.id %>" data-bs-dismiss="modal" data-team='home' data-name="<%= participation.user.name %>">
                    <img src="<%= participation.user.photo.present? ?cl_image_path(participation.user.photo.key) :asset_path('user.png') %>">
                    <p><%= participation.user.player_name %></p>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <%# MODAL POUR LES CHANGEMENTS %>
    <div class="modal fade" id="stats_3" aria-hidden="true" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="pierre">
              <div class="laura1">
                <% @titulaires.each do |participation| %>
                  <div class="card-select-player card-test1 photogood" data-action='click->add-stats#selectPlayer'>
                    <img src="<%= participation.user.photo.present? ?cl_image_path(participation.user.photo.key) :asset_path('user.png') %>">
                    <p><%= participation.user.player_name %></p>
                    <i class="fa-regular fa-circle-check"></i>
                  </div>
                <% end %>
              </div>
              <div class="laura1">
                <% @non_titulaires.each do |participation| %>
                  <div class="card-select-player card-test2 photogood" data-action='click->add-stats#selectPlayer'>
                    <img src="<%= participation.user.photo.present? ?cl_image_path(participation.user.photo.key) :asset_path('user.png') %>">
                    <p><%= participation.user.player_name %></p>
                    <i class="fa-regular fa-circle-check"></i>
                  </div>
                <% end %>
              </div>
              <div class="laura1">
                <span class="btn-rectangle minibtnnext" data-bs-target="#stats_4" data-bs-toggle="modal">Next</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="stats_4" aria-hidden="true" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="card-test11">
              <span class="timerem">Remaining Time :</span>
              <div class="temps1" style="margin-top: 2vh;">
                <span data-bs-dismiss="modal">10:00</span>
                <span data-bs-dismiss="modal">9:30</span>
                <span data-bs-dismiss="modal">9:00</span>
                <span data-bs-dismiss="modal">8:30</span>
                <span data-bs-dismiss="modal">8:00</span>
              </div>
              <div class="temps1">
                <span data-bs-dismiss="modal">7:30</span>
                <span data-bs-dismiss="modal">7:00</span>
                <span data-bs-dismiss="modal">6:30</span>
                <span data-bs-dismiss="modal">6:00</span>
                <span data-bs-dismiss="modal">5:30</span>
              </div>
              <div class="temps1">
                <span data-bs-dismiss="modal">5:00</span>
                <span data-bs-dismiss="modal">4:30</span>
                <span data-bs-dismiss="modal">4:00</span>
                <span data-bs-dismiss="modal">3:30</span>
                <span data-bs-dismiss="modal">3:00</span>
              </div>
              <div class="temps1">
                <span data-bs-dismiss="modal">2:30</span>
                <span data-bs-dismiss="modal">2:00</span>
                <span data-bs-dismiss="modal">1:30</span>
                <span data-bs-dismiss="modal">1:00</span>
                <span data-bs-dismiss="modal">0:30</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  <% end %>

</div>


<div class="lillildiv">
  <%= link_to 'End QT1', stats_game_path(Game.find(Game.last.id)), id: 'endQtButton', class: 'btn-rectangle no-underline' %>
</div>


<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
  $(document).ready(function() {
    var buttonTexts = ['End QT1', 'End QT2', 'End QT3', 'End Game'];
    var currentButtonTextIndex = 0;

    $('#endQtButton').on('click', function(e) {
      e.preventDefault();

      if (currentButtonTextIndex === buttonTexts.length - 1) {
        window.location.href = '<%= stats_game_path(@game) %>';
        return;
      }

      $(this).text(buttonTexts[++currentButtonTextIndex]);
    });
  });
</script>
